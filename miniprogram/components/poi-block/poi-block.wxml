<!--
  POI Block - åœ°ç‚¹å—ç»„ä»¶
  å¤ç”¨åŸæœ‰çš„æ¯›ç»ç’ƒæ´»åŠ¨å¡ç‰‡æ ·å¼
-->
<view class="poi-block {{editMode ? 'edit-mode' : ''}}">
  <!-- åˆ é™¤æŒ‰é’® (ä»…ç¼–è¾‘æ¨¡å¼å¯è§) -->
  <view class="delete-btn" wx:if="{{editMode}}" catchtap="onDeleteTap">
    <text class="delete-icon">Ã—</text>
  </view>

  <!-- å…ƒä¿¡æ¯ï¼šæ—¶é—´/æ—¶é•¿/è´¹ç”¨ -->
  <view class="card-meta">
    <view class="meta-item">
      <text class="icon">â°</text>
      <picker wx:if="{{editMode}}" mode="time" value="{{block.content.startTime || block.content.time || '08:00'}}" bindchange="onTimePick">
        <view class="picker-display">{{block.content.startTime || block.content.time || 'é€‰æ‹©æ—¶é—´'}}</view>
      </picker>
      <text wx:else>{{block.content.startTime || block.content.time || 'æ—¶é—´'}}</text>
    </view>
    <text class="dot">Â·</text>
    <view class="meta-item">
      <text class="icon">â³</text>
      <picker wx:if="{{editMode}}" mode="multiSelector" range="{{durationColumns}}" value="{{durationSelected}}" bindchange="onDurationPick">
        <view class="picker-display">{{formattedDuration || 'é€‰æ‹©æ—¶é•¿'}}</view>
      </picker>
      <text wx:else>{{formattedDuration || (block.content.duration ? (block.content.duration + 'åˆ†é’Ÿ') : '')}}</text>
    </view>
    <text class="dot" wx:if="{{block.content.cost || editMode}}">Â·</text>
    <view class="meta-item" wx:if="{{block.content.cost || editMode}}">
      <text class="icon">ğŸ’°</text>
      <input wx:if="{{editMode}}" class="meta-input" value="{{block.content.cost === 0 ? '' : block.content.cost}}" bindblur="onInputBlur" data-field="cost" placeholder="é‡‘é¢" type="digit"/>
      <text wx:else>Â¥{{block.content.cost}}</text>
    </view>
  </view>

  <!-- ä¸»å†…å®¹åŒº -->
  <view class="main-content">
    <!-- åç§°å’Œå¯¼èˆªæŒ‰é’® -->
    <view class="name-row">
      <input wx:if="{{editMode}}" class="poi-input title" value="{{block.content.name}}" bindblur="onInputBlur" data-field="name" placeholder="åœ°ç‚¹åç§°"/>
      <text wx:else class="poi-name">{{block.content.name}}</text>
      <view class="nav-btn" bindtap="onNavTap" wx:if="{{!editMode}}">
        <view class="nav-icon-bg">
          <text class="nav-icon">â†—</text>
        </view>
        <text class="nav-text">å»è¿™é‡Œ</text>
      </view>
    </view>

    <!-- æè¿°/åœ°å€ (å¯ç¼–è¾‘) -->
    <view class="desc-wrapper">
      <textarea
        wx:if="{{editMode}}"
        class="desc-input"
        auto-height
        maxlength="200"
        placeholder="ç‚¹å‡»ç¼–è¾‘æ´»åŠ¨æè¿°..."
        value="{{block.content.description}}"
        bindinput="onDescInput"
        bindblur="onDescBlur"
      />
      <text wx:else class="desc-text">{{block.content.description || block.content.address || 'æš‚æ— æè¿°'}}</text>
    </view>


    <!-- æ ‡ç­¾ -->
    <view class="tags-row" wx:if="{{block.content.tags && block.content.tags.length > 0}}">
      <text class="tag" wx:for="{{block.content.tags}}" wx:key="*this">{{item}}</text>
    </view>

    <!-- å¤‡æ³¨ -->
    <view class="card-note">
      <input wx:if="{{editMode}}" class="note-input" value="{{block.content.note}}" bindblur="onInputBlur" data-field="note" placeholder="æ·»åŠ å¤‡æ³¨ (å¦‚: æå‰ä¹°ç¥¨)"/>
      <text wx:elif="{{block.content.note}}" class="note-text">ğŸ’¡ {{block.content.note}}</text>
    </view>
  </view>
</view>

