<!--pages/trips/trips.wxml-->
<view class="container">
  <!-- çŠ¶æ€ç­›é€‰ -->
  <view class="status-tabs">
    <view class="tab {{currentStatus === 'all' ? 'active' : ''}}" bindtap="switchStatus" data-status="all">
      <text>å…¨éƒ¨</text>
      <text class="count">{{tripCounts.all}}</text>
    </view>
    <view class="tab {{currentStatus === 'planning' ? 'active' : ''}}" bindtap="switchStatus" data-status="planning">
      <text>è§„åˆ’ä¸­</text>
      <text class="count">{{tripCounts.planning}}</text>
    </view>
    <view class="tab {{currentStatus === 'ongoing' ? 'active' : ''}}" bindtap="switchStatus" data-status="ongoing">
      <text>è¿›è¡Œä¸­</text>
      <text class="count">{{tripCounts.ongoing}}</text>
    </view>
    <view class="tab {{currentStatus === 'completed' ? 'active' : ''}}" bindtap="switchStatus" data-status="completed">
      <text>å·²å®Œæˆ</text>
      <text class="count">{{tripCounts.completed}}</text>
    </view>
  </view>

  <!-- è¡Œç¨‹åˆ—è¡¨ -->
  <view class="trip-list" wx:if="{{filteredTrips.length > 0}}">
    <view 
      class="trip-card {{item.status}}" 
      wx:for="{{filteredTrips}}" 
      wx:key="id"
      bindtap="goToDetail"
      data-id="{{item._id}}"
    >
      <!-- å°é¢å›¾ -->
      <image class="trip-cover" src="{{item.cover || '/images/3s.jpg'}}" mode="aspectFill"></image>
      
      <!-- çŠ¶æ€å¾½ç«  -->
      <view class="status-badge {{item.status}}">
        <text wx:if="{{item.status === 'planning'}}">ğŸ“ è§„åˆ’ä¸­</text>
        <text wx:if="{{item.status === 'ongoing'}}">ğŸš€ è¿›è¡Œä¸­</text>
        <text wx:if="{{item.status === 'completed'}}">âœ… å·²å®Œæˆ</text>
      </view>

      <!-- ä¿¡æ¯åŒºåŸŸ -->
      <view class="trip-info">
        <text class="trip-title">{{item.title}}</text>
        <view class="trip-meta">
          <text class="meta-item">ğŸ“ {{item.city}}</text>
          <text class="meta-item">ğŸ“… {{item.days}}å¤©</text>
          <text class="meta-item" wx:if="{{item.meta && item.meta.totalCost}}">ğŸ’° Â¥{{item.meta.totalCost}}</text>
        </view>
        <text class="trip-date">åˆ›å»ºäº {{item.createdAt}}</text>
      </view>

      <!-- æ“ä½œæŒ‰é’® -->
      <view class="trip-actions" catchtap="showActions" data-id="{{item.id}}">
        <text class="action-icon">â‹®</text>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{filteredTrips.length === 0 && !loading}}">
    <text class="empty-icon">ğŸ—ºï¸</text>
    <text class="empty-text">è¿˜æ²¡æœ‰è¡Œç¨‹</text>
    <text class="empty-hint">å»ã€Œå‘ç°ã€é¡µé¢åˆ›å»ºä½ çš„ç¬¬ä¸€ä»½è·¯ä¹¦å§</text>
    <button class="empty-btn" bindtap="goToDiscover">å»åˆ›å»º</button>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading-state" wx:if="{{loading}}">
    <text class="loading-text">åŠ è½½ä¸­...</text>
  </view>
</view>

