<!--pages/discover/discover.wxml-->
<view class="container">
  <!-- å¤´éƒ¨åŒºåŸŸ -->
  <view class="header">
    <text class="title">âœˆï¸ å¼€å§‹ä½ çš„æ—…ç¨‹</text>
    <text class="subtitle">AI æ™ºèƒ½è§„åˆ’ï¼Œ3ç§’ç”Ÿæˆä¸“å±è·¯ä¹¦</text>
  </view>

  <!-- æ–°å»ºè·¯ä¹¦å¡ç‰‡ -->
  <view class="create-section">
    <!-- AI å¿«é€Ÿç”Ÿæˆ -->
    <view class="create-card main-card" bindtap="goToAIGenerate">
      <view class="card-icon">ğŸ¤–</view>
      <view class="card-content">
        <text class="card-title">AI ä¸€é”®ç”Ÿæˆ</text>
        <text class="card-desc">å‘Šè¯‰æˆ‘ç›®çš„åœ°ï¼Œ3ç§’å‡ºè·¯ä¹¦</text>
      </view>
      <view class="card-arrow">â†’</view>
    </view>

    <!-- ç©ºç™½åˆ›å»º -->
    <view class="create-card" bindtap="createBlankTrip">
      <view class="card-icon">ğŸ“</view>
      <view class="card-content">
        <text class="card-title">ç©ºç™½è·¯ä¹¦</text>
        <text class="card-desc">ä»é›¶å¼€å§‹ï¼Œè‡ªç”±è§„åˆ’</text>
      </view>
      <view class="card-arrow">â†’</view>
    </view>
  </view>

  <!-- é€‰æ‹©å™¨åŒºåŸŸï¼ˆAI ç”Ÿæˆå‚æ•°ï¼‰ -->
  <view class="selector-section" wx:if="{{showAIPanel}}">
    <view class="section-title">ğŸ¯ å¿«é€Ÿè®¾ç½®</view>
    
    <!-- åŸå¸‚é€‰æ‹© -->
    <view class="selector-item">
      <text class="label">ç›®çš„åœ°</text>
      <picker mode="selector" range="{{cities}}" value="{{cityIndex}}" bindchange="onCityChange">
        <view class="picker-value">{{cities[cityIndex]}} â–¾</view>
      </picker>
    </view>

    <!-- å¤©æ•°é€‰æ‹© -->
    <view class="selector-item">
      <text class="label">æ—…è¡Œå¤©æ•°</text>
      <picker mode="selector" range="{{days}}" value="{{dayIndex}}" bindchange="onDayChange">
        <view class="picker-value">{{days[dayIndex]}}å¤© â–¾</view>
      </picker>
    </view>

    <!-- å‡ºè¡Œé£æ ¼ -->
    <view class="selector-item">
      <text class="label">å‡ºè¡Œé£æ ¼</text>
      <picker mode="selector" range="{{intents}}" value="{{intentIndex}}" bindchange="onIntentChange">
        <view class="picker-value">{{intents[intentIndex]}} â–¾</view>
      </picker>
    </view>

    <!-- ç”ŸæˆæŒ‰é’® -->
    <button class="generate-btn" bindtap="generateTrip" loading="{{loading}}" disabled="{{loading}}">
      {{loading ? 'ç”Ÿæˆä¸­...' : 'âœ¨ ç«‹å³ç”Ÿæˆè·¯ä¹¦'}}
    </button>
  </view>

  <!-- æ¨èæ¨¡ç‰ˆåŒºåŸŸ -->
  <view class="template-section">
    <view class="section-header">
      <text class="section-title">ğŸ”¥ çƒ­é—¨è·¯ä¹¦æ¨¡ç‰ˆ</text>
      <text class="section-more" bindtap="viewAllTemplates">æ›´å¤š â†’</text>
    </view>

    <scroll-view class="template-scroll" scroll-x="{{true}}" enhanced="{{true}}" show-scrollbar="{{false}}">
      <view class="template-list">
        <view class="template-card" wx:for="{{templates}}" wx:key="id" bindtap="useTemplate" data-id="{{item.id}}">
          <image class="template-cover" src="{{item.cover}}" mode="aspectFill"></image>
          <view class="template-info">
            <text class="template-title">{{item.title}}</text>
            <text class="template-meta">{{item.city}} Â· {{item.days}}å¤©</text>
            <view class="template-tags">
              <text class="tag" wx:for="{{item.tags}}" wx:for-item="tag" wx:key="*this">{{tag}}</text>
            </view>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- åˆ†ç±»å…¥å£ -->
  <view class="category-section">
    <view class="section-title">ğŸ·ï¸ åˆ†ç±»æ¢ç´¢</view>
    <view class="category-grid">
      <view class="category-item" wx:for="{{categories}}" wx:key="id" bindtap="goToCategory" data-id="{{item.id}}">
        <text class="category-icon">{{item.icon}}</text>
        <text class="category-name">{{item.name}}</text>
      </view>
    </view>
  </view>
</view>

