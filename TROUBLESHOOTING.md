# é—®é¢˜æ’æŸ¥ä¸è§£å†³æŒ‡å—

## ğŸ› å°ç¨‹åºç ç”Ÿæˆå¤±è´¥

### é”™è¯¯ä¿¡æ¯
```
errCode: 41030 | errMsg: openapi.wxacode.getUnlimited fail invalid page
```

### é—®é¢˜åŸå› 
`wxacode.getUnlimited` API çš„ `page` å‚æ•°æ ¼å¼ä¸æ­£ç¡®æˆ–ä¸éœ€è¦ã€‚

### âœ… è§£å†³æ–¹æ¡ˆ

#### 1. æ›´æ–°äº‘å‡½æ•°ä»£ç 
å·²ä¿®å¤ `cloudfunctions/generateQRCode/index.js`ï¼š
- ç§»é™¤äº† `page` å‚æ•°
- `getUnlimited` ä¸ä¼  page ä¼šè‡ªåŠ¨è·³è½¬åˆ°ä¸»é¡µ
- æ·»åŠ äº†è¯¦ç»†çš„æ—¥å¿—

#### 2. é‡æ–°ä¸Šä¼ äº‘å‡½æ•°ï¼ˆå¿…é¡»ï¼ï¼‰
```
æ­¥éª¤ï¼š
1. å³é”®ç‚¹å‡» cloudfunctions/generateQRCode
2. é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²ï¼šäº‘ç«¯å®‰è£…ä¾èµ–"
3. ç­‰å¾…ä¸Šä¼ å®Œæˆï¼ˆçœ‹åˆ°"ä¸Šä¼ æˆåŠŸ"æç¤ºï¼‰
4. é‡æ–°ç¼–è¯‘å°ç¨‹åº
5. é‡æ–°ç”Ÿæˆå¡ç‰‡æµ‹è¯•
```

#### 3. éªŒè¯ä¿®å¤
ç”Ÿæˆå¡ç‰‡åï¼ŒæŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—ï¼š
```
âœ… åº”è¯¥çœ‹åˆ°ï¼š
- "å¼€å§‹ç”Ÿæˆå°ç¨‹åºç ï¼Œscene: plan_xxxxx"
- "å°ç¨‹åºç ç”ŸæˆæˆåŠŸ"
- "å°ç¨‹åºç ä¸Šä¼ æˆåŠŸ: cloud://..."

âŒ å¦‚æœè¿˜æ˜¯å¤±è´¥ï¼š
- æŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—ï¼ˆäº‘å¼€å‘æ§åˆ¶å° -> äº‘å‡½æ•° -> generateQRCode -> æ—¥å¿—ï¼‰
- æ£€æŸ¥æƒé™é…ç½®ï¼ˆconfig.jsonï¼‰
- ç¡®è®¤å°ç¨‹åºå·²å‘å¸ƒæˆ–åœ¨ä½“éªŒç‰ˆ
```

### å¤‡é€‰æ–¹æ¡ˆ

å¦‚æœ `getUnlimited` ä»ç„¶å¤±è´¥ï¼Œå¯ä»¥ä½¿ç”¨ `get` æ–¹æ³•ï¼š

```javascript
// åœ¨ cloudfunctions/generateQRCode/index.js ä¸­
const result = await cloud.openapi.wxacode.get({
  path: 'pages/index/index',
  width: 280,
});
```

## ğŸ–¼ï¸ å…¨å±æ˜¾ç¤ºé—®é¢˜

### é—®é¢˜æè¿°
å…¨å±æ˜¾ç¤ºæ—¶å›¾ç‰‡å¯èƒ½å‡ºç°ï¼š
1. é«˜åº¦è¢«å‹ç¼©
2. æ— æ³•æ»šåŠ¨
3. æ¯”ä¾‹å¤±çœŸ

### âœ… è§£å†³æ–¹æ¡ˆ

#### å·²ä¼˜åŒ–çš„æ ·å¼
```css
.fullscreen-overlay {
  overflow-y: scroll;  /* å…è®¸æ»šåŠ¨ */
  padding: 20rpx 0;    /* ä¸Šä¸‹ç•™ç™½ */
}

.fullscreen-image {
  width: 100%;         /* å®½åº¦100% */
  display: block;      /* å—çº§å…ƒç´  */
  margin: 0 auto;      /* å±…ä¸­ */
}

.fullscreen-tip {
  position: fixed;     /* å›ºå®šåœ¨åº•éƒ¨ */
  bottom: 60rpx;
  pointer-events: none; /* ä¸é˜»æŒ¡ç‚¹å‡» */
}
```

#### æµ‹è¯•æ­¥éª¤
1. ç”Ÿæˆä¸€ä¸ª2å¤©æˆ–3å¤©çš„è¡Œç¨‹ï¼ˆé•¿å›¾ï¼‰
2. ç‚¹å‡»å›¾ç‰‡è¿›å…¥å…¨å±
3. å°è¯•ä¸Šä¸‹æ»‘åŠ¨
4. æ£€æŸ¥å›¾ç‰‡æ˜¯å¦å®Œæ•´æ˜¾ç¤º

#### å¦‚æœè¿˜æ˜¯æœ‰é—®é¢˜

**æ–¹æ¡ˆAï¼šä½¿ç”¨ scroll-view**
```xml
<!-- åœ¨ index.wxml ä¸­ -->
<view class="fullscreen-overlay" wx:if="{{showFullscreen}}" bindtap="closeFullscreen">
  <scroll-view scroll-y="true" style="height: 100vh;">
    <image class="fullscreen-image" src="{{cardImagePath}}" mode="widthFix"></image>
  </scroll-view>
  <view class="fullscreen-tip">ç‚¹å‡»å…³é—­ | é•¿æŒ‰ä¿å­˜</view>
</view>
```

**æ–¹æ¡ˆBï¼šä½¿ç”¨ image-preview**
```javascript
// åœ¨ index.js ä¸­
showFullscreenImage() {
  wx.previewImage({
    urls: [this.data.cardImagePath],
    current: this.data.cardImagePath
  });
}
```

## ğŸ“± æµ‹è¯•ç¯å¢ƒé—®é¢˜

### è­¦å‘Šä¿¡æ¯
```
[Deprecation] SharedArrayBuffer will require cross-origin isolation
```

**è¯´æ˜**ï¼šè¿™æ˜¯æµè§ˆå™¨çš„è­¦å‘Šï¼Œä¸å½±å“å°ç¨‹åºåŠŸèƒ½ï¼Œå¯ä»¥å¿½ç•¥ã€‚

### Canvas 2D å»ºè®®
```
[Component] <canvas>: canvas 2d æ¥å£æ”¯æŒåŒå±‚æ¸²æŸ“ä¸”æ€§èƒ½æ›´ä½³
```

**ä¼˜åŒ–å»ºè®®**ï¼š
å¦‚æœéœ€è¦æ›´å¥½çš„æ€§èƒ½ï¼Œå¯ä»¥å‡çº§åˆ° Canvas 2D APIï¼š

```xml
<!-- æ–°ç‰ˆ Canvas -->
<canvas type="2d" id="cardCanvas" class="hidden-canvas"></canvas>
```

```javascript
// æ–°ç‰ˆ API
const canvas = await wx.createSelectorQuery()
  .select('#cardCanvas')
  .node()
  .exec();
```

ä½†å½“å‰ç‰ˆæœ¬çš„ Canvas API å·²ç»è¶³å¤Ÿä½¿ç”¨ã€‚

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹å®Œæ•´æ—¥å¿—
```javascript
// åœ¨å…³é”®ä½ç½®æ·»åŠ æ—¥å¿—
console.log('å½“å‰çŠ¶æ€:', {
  cardImagePath: this.data.cardImagePath,
  showFullscreen: this.data.showFullscreen,
  canvasHeight: this.data.canvasHeight
});
```

### 2. æ£€æŸ¥å›¾ç‰‡ç”Ÿæˆ
```javascript
// åœ¨ canvasToImage æˆåŠŸå
console.log('å›¾ç‰‡ç”ŸæˆæˆåŠŸ:', res.tempFilePath);
console.log('å›¾ç‰‡ä¿¡æ¯:', {
  width: res.width,
  height: res.height
});
```

### 3. çœŸæœºè°ƒè¯•
å¼€å‘è€…å·¥å…·å’ŒçœŸæœºå¯èƒ½æœ‰å·®å¼‚ï¼Œå»ºè®®ï¼š
1. ä½¿ç”¨çœŸæœºè°ƒè¯•åŠŸèƒ½
2. æˆ–ç”Ÿæˆä½“éªŒç‰ˆåœ¨æ‰‹æœºä¸Šæµ‹è¯•

## ğŸ“‹ å®Œæ•´æµ‹è¯•æ¸…å•

### å°ç¨‹åºç æµ‹è¯•
- [ ] äº‘å‡½æ•°å·²é‡æ–°ä¸Šä¼ 
- [ ] æ§åˆ¶å°æ˜¾ç¤º"å°ç¨‹åºç ç”ŸæˆæˆåŠŸ"
- [ ] å›¾ç‰‡å³ä¸‹è§’æ˜¾ç¤ºå°ç¨‹åºç 
- [ ] å°ç¨‹åºç å¯ä»¥æ‰«æ

### å…¨å±æ˜¾ç¤ºæµ‹è¯•
- [ ] ç‚¹å‡»å›¾ç‰‡èƒ½å…¨å±
- [ ] é•¿å›¾å¯ä»¥ä¸Šä¸‹æ»šåŠ¨
- [ ] å›¾ç‰‡æ¯”ä¾‹æ­£ç¡®
- [ ] æç¤ºæ–‡å­—æ˜¾ç¤ºåœ¨åº•éƒ¨
- [ ] ç‚¹å‡»ä»»æ„ä½ç½®èƒ½å…³é—­
- [ ] é•¿æŒ‰å›¾ç‰‡èƒ½ä¿å­˜

### ä¸»é¢˜å’ŒèƒŒæ™¯æµ‹è¯•
- [ ] ä¸»é¢˜é€‰æ‹©å™¨æ˜¾ç¤ºé•¿æ¡å¡ç‰‡
- [ ] åˆ‡æ¢ä¸»é¢˜èƒ½é‡æ–°ç”Ÿæˆ
- [ ] èƒŒæ™¯é€‰æ‹©å™¨æ­£å¸¸æ˜¾ç¤º
- [ ] è‡ªå®šä¹‰èƒŒæ™¯èƒ½ä¸Šä¼ 
- [ ] èƒŒæ™¯æ­£ç¡®åº”ç”¨åˆ°å›¾ç‰‡

## ğŸš€ å¿«é€Ÿä¿®å¤æ­¥éª¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼ŒæŒ‰ä»¥ä¸‹é¡ºåºæ“ä½œï¼š

1. **é‡æ–°ä¸Šä¼ äº‘å‡½æ•°**
   ```
   å³é”® cloudfunctions/generateQRCode
   é€‰æ‹©"ä¸Šä¼ å¹¶éƒ¨ç½²ï¼šäº‘ç«¯å®‰è£…ä¾èµ–"
   ```

2. **æ¸…é™¤ç¼“å­˜**
   ```
   å·¥å…·æ  -> æ¸…é™¤ç¼“å­˜ -> æ¸…é™¤å…¨éƒ¨ç¼“å­˜
   ```

3. **é‡æ–°ç¼–è¯‘**
   ```
   ç‚¹å‡»"ç¼–è¯‘"æŒ‰é’®
   ```

4. **é‡æ–°æµ‹è¯•**
   ```
   ç”Ÿæˆæ–°çš„å¡ç‰‡
   æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—
   æµ‹è¯•æ‰€æœ‰åŠŸèƒ½
   ```

## ğŸ“ ä»ç„¶æœ‰é—®é¢˜ï¼Ÿ

### æ£€æŸ¥æ¸…å•
- [ ] äº‘å‡½æ•°å·²ä¸Šä¼ ï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰
- [ ] å°ç¨‹åºåŸºç¡€åº“ç‰ˆæœ¬ >= 2.2.3
- [ ] äº‘å¼€å‘ç¯å¢ƒå·²å¼€é€š
- [ ] æƒé™é…ç½®æ­£ç¡®
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸

### è·å–å¸®åŠ©
1. æŸ¥çœ‹äº‘å‡½æ•°æ—¥å¿—
2. æŸ¥çœ‹æ§åˆ¶å°å®Œæ•´æ—¥å¿—
3. æˆªå›¾é”™è¯¯ä¿¡æ¯
4. æ£€æŸ¥ç½‘ç»œè¯·æ±‚

ç¥è°ƒè¯•é¡ºåˆ©ï¼ğŸ‰

